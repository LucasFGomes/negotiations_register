{"version":3,"sources":["../../app-es6/dao/NegotiationDAO.js"],"names":["Negotiation","NegotiationDAO","connection","_connection","_store","negotiation","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","console","log","target","error","cursor","openCursor","negotiations","currentElement","result","data","value","push","_date","_quantity","_value","continue","clear"],"mappings":";;;;;;;;;;;;;;;AAAOA,iB;;;;;;;;;;;;;;;;;;;;;AAEcC,oB;AAEnB,gCAAYC,UAAZ,EAAwB;AAAA;;AACtB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,cAAd;AACD;;;;iCAEMC,W,EAAa;AAAA;;AAElB,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,kBAAIC,UAAU,MAAKN,WAAL,CACXO,WADW,CACC,CAAC,MAAKN,MAAN,CADD,EACgB,WADhB,EAEXO,WAFW,CAEC,MAAKP,MAFN,EAGXQ,GAHW,CAGPP,WAHO,CAAd;;AAKAI,sBAAQI,SAAR,GAAoB,UAACC,CAAD,EAAO;AACzBP;AACD,eAFD;;AAIAE,sBAAQM,OAAR,GAAkB,UAACD,CAAD,EAAO;AACvBE,wBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,uBAAO,0CAAP;AACD,eAHD;AAID,aAdM,CAAP;AAgBD;;;oCAES;AAAA;;AAER,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,kBAAIY,SAAS,OAAKjB,WAAL,CACVO,WADU,CACE,CAAC,OAAKN,MAAN,CADF,EACiB,WADjB,EAEVO,WAFU,CAEE,OAAKP,MAFP,EAGViB,UAHU,EAAb;;AAKA,kBAAIC,eAAe,EAAnB;;AAEAF,qBAAOP,SAAP,GAAmB,UAACC,CAAD,EAAO;;AAExB,oBAAIS,iBAAiBT,EAAEI,MAAF,CAASM,MAA9B;;AAEA,oBAAID,cAAJ,EAAoB;;AAElB,sBAAIE,OAAOF,eAAeG,KAA1B;AACAJ,+BAAaK,IAAb,CAAkB,IAAI3B,WAAJ,CAAgByB,KAAKG,KAArB,EAA4BH,KAAKI,SAAjC,EAA4CJ,KAAKK,MAAjD,CAAlB;;AAEAP,iCAAeQ,QAAf;AAED,iBAPD,MAOO;AACLxB,0BAAQe,YAAR;AACD;AAEF,eAfD;;AAiBAF,qBAAOL,OAAP,GAAiB,UAACD,CAAD,EAAO;AACtBE,wBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,uBAAO,yCAAP;AACD,eAHD;AAKD,aA9BM,CAAP;AAgCD;;;sCAEW;AAAA;;AAEV,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;;AAEtC,kBAAIC,UAAU,OAAKN,WAAL,CAAiBO,WAAjB,CAA6B,CAAC,OAAKN,MAAN,CAA7B,EAA4C,WAA5C,EACXO,WADW,CACC,OAAKP,MADN,EAEX4B,KAFW,EAAd;;AAIAvB,sBAAQI,SAAR,GAAoB,UAACC,CAAD;AAAA,uBAAOP,QAAQ,mCAAR,CAAP;AAAA,eAApB;;AAEAE,sBAAQM,OAAR,GAAkB,UAACD,CAAD,EAAO;AACvBE,wBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAX,uBAAO,yCAAP;AACD,eAHD;AAKD,aAbM,CAAP;AAeD;;;;;;yBAhFkBP,c","file":"NegotiationDAO.js","sourcesContent":["import Negotiation from \"../models/Negotiation\";\r\n\r\nexport default class NegotiationDAO {\r\n\r\n  constructor(connection) {\r\n    this._connection = connection;\r\n    this._store = 'negotiations';\r\n  }\r\n\r\n  insert(negotiation) {\r\n\r\n    return new Promise((resolve, reject) => {\r\n      let request = this._connection\r\n        .transaction([this._store], 'readwrite')\r\n        .objectStore(this._store)\r\n        .add(negotiation);\r\n\r\n      request.onsuccess = (e) => {\r\n        resolve();\r\n      }\r\n\r\n      request.onerror = (e) => {\r\n        console.log(e.target.error);\r\n        reject('Não foi possível adicionar a negociação!');\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  findAll() {\r\n\r\n    return new Promise((resolve, reject) => {\r\n      let cursor = this._connection\r\n        .transaction([this._store], 'readwrite')\r\n        .objectStore(this._store)\r\n        .openCursor();\r\n\r\n      let negotiations = [];\r\n\r\n      cursor.onsuccess = (e) => {\r\n\r\n        let currentElement = e.target.result;\r\n\r\n        if (currentElement) {\r\n\r\n          let data = currentElement.value;\r\n          negotiations.push(new Negotiation(data._date, data._quantity, data._value));\r\n\r\n          currentElement.continue();\r\n\r\n        } else {\r\n          resolve(negotiations);\r\n        }\r\n\r\n      }\r\n\r\n      cursor.onerror = (e) => {\r\n        console.log(e.target.error);\r\n        reject('Não foi possível listar as negociações!');\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  deleteAll() {\r\n\r\n    return new Promise((resolve, reject) => {\r\n\r\n      let request = this._connection.transaction([this._store], 'readwrite')\r\n        .objectStore(this._store)\r\n        .clear();\r\n\r\n      request.onsuccess = (e) => resolve('Negociações apagadas com sucesso!');\r\n\r\n      request.onerror = (e) => {\r\n        console.log(e.target.error);\r\n        reject('Não foi possível apagar as negociações!');\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n}"]}